# 导出到 USB

如果您购买了可选的 USB 导出许可证，您将能将您的安装和配置导出到 USB 设备。这会让您创建一个 Opus 的“便携”版，您可以在其他计算机上运行它，而无需在这些计算机上安装 Opus。此便携版完全独立于导出设备，并且不会对它运行的系统进行任何注册表或其他更改。

USB 导出功能需要额外付费，因为它实际上授予了您在一个其他机器上同时运行 Opus 的额外许可证。如果您在购买 Opus 时没有选择此功能，您可以随时在 GP Software 网站的 [我的帐户](https://www.gpsoft.com.au/DScripts/licencemanager.asp) 页面中添加此功能。您可以从 **许可证管理器**（在 **帮助** 菜单中）查看是否启用了 USB 导出功能。

要开始 USB 导出过程，请选择 **设置** 菜单中的 **备份和还原** 命令。单击 **导出到 USB 闪存盘** 选项，然后单击 **下一步** 继续。

![](/Manual/images/media/usb_export.png)

对话框显示您的 USB 设备列表。除了正常的闪存盘和外部 USB 硬盘驱动器外，Opus 还支持 [U3](https://en.wikipedia.org/wiki/U3) 设备（尽管此标准现在已经或多或少不复存在）——所有 U3 设备将显示不同的图标。Opus 还支持安装了 [PortableApps](http://portableapps.com/) 菜单系统的设备。

您可以选择多种不同的向 USB 驱动器导出方式：

- 默认行为是将 Opus 导出到选定的驱动器。程序和配置文件将复制到选定设备的根目录下的一个新文件夹中。
- **将此驱动器用作加密狗** 选项允许您导出到其他位置——选定的 USB 驱动器只会用于验证导出的许可证。例如，Opus 并没有将 [VeraCrypt](https://en.wikipedia.org/wiki/VeraCrypt) 加密容器视为 USB 驱动器，因此，通常您将无法选择该容器来导出。使用此 *加密狗* 选项，您可以将 Opus 导出到加密驱动器，而“父级”USB 驱动器本身将只用于授权目的。
- U3 设备在列表中将显示为两个单独的条目——U3 设备（有 U3 图标）和一个正常的 USB 驱动器。这些表示 U3 设备上的两个单独分区。如果您想制作一个 **.u3p** 捆绑包（可以安装到 U3 程序启动器中），您应该选择 U3 设备条目。（注意：由于停止使用的 U3 软件本身的限制，U3 仅在 32 位计算机上可用。）
- [PortableApps](http://portableapps.com) 设备会自动检测。当您选择一个已安装了 PortableApps 的设备时，Opus 将自动创建必要的文件夹结构，将便携版集成到 PortableApps 启动器菜单中。

选择您想导出的驱动器，然后 **单击** 下一步来继续。这时，如果您选择了 **将此驱动器用作加密狗** 选项，系统将提示您要将 Opus 导出的实际位置。

接下来，您将获得三个选择，以确定导出 Directory Opus 的哪种版本：

- **Directory Opus 32 位 (x86)**：这将导出 Directory Opus 的 32 位副本。导出的副本将在 32 位和 64 位 Windows 上运行，但在 64 位上会有一定的功能限制。（请参见上文。）
- **Directory Opus 64 位 (x64)**：这将导出 Directory Opus 的 64 位副本。导出的副本将只能在 64 位版本的 Windows 上运行；它将无法在 32 位版本的 Windows 上运行。
- **这两个版本**：这将将 Directory Opus 的 32 位副本和 64 位副本导出到同一个设备。放置在设备根目录中的小 DOPUS.EXE 程序在您运行它时，将自动选择最佳副本。除非您需要最大限度地减少空间使用，或者很清楚您始终会使用该 USB 记忆棒搭配 32 位或 64 位计算机，否则这是推荐的选项。

系统还将要求您选择要随同导出的副本一起包含哪些元素，这允许您通过排除不需要的组件来减少空间使用和导出过程的持续时间：

- **插件**：选择要包括哪些查看器和 VFS 插件。这里只列出了“USB 安全”插件；这意味着这些插件设计为不会在 USB 运行时在主机上留下任何内容（如注册表中）。某些第三方插件不是 USB 安全的，因此，这里不会列出这些插件。
- **语言**：始终会包括英语，但这也允许您选择要包括的其他语言文件（如果您愿意）。
- **帮助文件**：包括此帮助文件。
- **当前配置**：您可以选择导出您的配置以及该程序。如果未选择此选项，导出的版本将从默认配置开始。您还可以选择要包含在配置中的哪些元素。

系统可能会为您提供选择导出配置使用的图像和声音文件的选项。这仅适用于存储在适当的 **Images** 和 **Sounds** Opus 配置目录下的文件。您可以通过在地址字段中输入 **/dopusdata** [文件夹别名](/Manual/basic_concepts/the_lister/navigation/aliases.zh.md) 来找到这些目录。（它们也可以存储在共享的 **/dopusglobaldata** 目录下。在导出到 USB 时，会合并私有配置和共享配置的元素。）位于其他位置的图像或声音将不会复制到 USB 驱动器；配置仍然可以指向这些文件，但导出的副本显然只能在您运行导出的 Opus 副本的计算机上的相同位置存在这些文件时加载这些文件。

最终确认页面显示在导出驱动器上所需的空间总量。单击 **下一步** 以继续导出。

通常，在运行 USB 版本时，不可用 **[资源管理器替换](/Manual/basic_concepts/explorer_replacement.zh.md)** 模式。这是因为资源管理器替换模式需要更改系统注册表，包括一些只能作为管理员（例如，从程序安装程序）进行的更改。但是，您可以通过编辑与便携式启动器一起创建的 INI 文件来为 USB 版本启用 **资源管理器替换** 模式的限制形式。在 USB 版本中打开资源管理器替换模式时，会进行一些（但不是全部）对系统注册表的修改，并且在便携版本退出后会自动还原旧值。您会发现，在便携版本中，资源管理器替换模式可能不如 Opus 的普通版本中运行得那样好——例如，某些第三方应用程序启动的文件夹可能会继续在资源管理器中打开。

可以在正常的 USB 导出中找到（或创建）此 INI 文件（名为 *DOPUS.ini*，通常位于设备的根目录中）或 PortableApps 导出（名为 *DirectoryOpusPortable.ini*）的 **F:\PortableApps\DirectoryOpusPortable\App\AppInfo** 文件夹中。以下是此 INI 文件格式的示例。

    # 这是 Directory Opus 便携启动器的示例 INI 文件。
#
# 在这个 INI 文件中，你可以设置的选项有：
#
# Allow资源管理器Replacement：确定在便携版本中资源管理器替换选项是否可用。
# “true”或“false”（默认 “false”）
#
# RunFromTempFolder：如果 Allow资源管理器Replacement 为 true，则确定启动器是否复制到主机系统中的 %TEMP% 文件夹并从那里运行。允许更安全地清理资源管理器替换注册表更改。
# “true”或“false”（默认 “true”）
#
# Auto文件窗口：便携版本启动时启用或禁用“自动文件窗口”语义。
# “true”或“false”（默认 “true”）
#
[DirectoryOpusPortable]
Allow资源管理器Replacement=false
RunFromTempFolder=true
Auto文件窗口=true