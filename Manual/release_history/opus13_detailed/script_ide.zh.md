# Directory Opus 13 - 详细发行说明

# 脚本 IDE

- 脚本管理对话框：
  - 脚本管理对话框现在是一个独立对话框，而不是配置中的一个选项。
  - 可以通过双击脚本或通过编辑按钮访问新的脚本编辑器（见下文）。
  - 支持配置的脚本旁边会显示齿轮按钮。
  - 对话框中的更改（例如禁用脚本）会立即生效。无需单击确定或应用。
- 脚本共享：
  - 共享按钮可以轻松地共享脚本。选定的脚本（独立脚本或包）及其所需的任何包含文件将自动捆绑到 Opus 脚本安装文件中。
  - Opus 脚本安装文件可以通过对话框或通过主窗口的设置 > 从脚本安装进行安装。这也适用于旧版本的独立脚本和脚本包。
  - 如果脚本需要较新版本的 Opus，脚本安装程序会向你发出警告，还会显示脚本将添加的命令和列的摘要。
  - 安装后，你可以从安装结果对话框将新命令或列拖到工具栏或文件列表中。
- 脚本编辑器：
  - 用于编写脚本和管理其资源的新集成编辑器。
  - 多文档、标签页式界面。
  - 允许你编辑独立脚本、脚本包及其资源。
  - 内置对话框和字符串（本地化）资源编辑器。
  - 可以轻松地将独立脚本转换为包。
  - 在脚本包中添加和管理图像、图标集和帮助文件。
  - 预先提供的代码段列表，通过拖放或复制/粘贴将常见代码添加到脚本中。
  - 如果你愿意，可以将自己的代码添加到代码段列表中以供将来重用。
  - 如果需要，可以选择使用外部文本编辑器。（IDE 会自动监视文件是否发生更改并更新。）
- 脚本模块：
  - 现在可以将大型脚本拆分为多个“模块”，而不是一个大文件。
  - 模块文件名必须以主脚本的名称开头，后接模块名称和 .osm 后缀。
  - //<示例://> “MyScript.js” 可能有一个名为 “MyScript.js.FirstModule.osm” 的模块文件。
  - 脚本 IDE 允许你为现有脚本创建新模块。
- 包含文件：
  - 可以通过新建脚本对话框创建。
  - “包含文件”允许你在不同的脚本之间共享代码（例如辅助函数），而无需重复相同的代码。
  - 包含文件的名称必须以 “inc_” 开头。
  - 包含文件可以实现 OnInitIncludeFile 方法向用户提供有关它们的信息，但这不是必需的。
  - 要从另一个脚本使用包含文件，请在脚本的最顶部添加一行：@include <包含文件>。
  - 还可以指定包含文件的最低所需版本。
  - 脚本 IDE 允许你使用 GUI 为脚本选择包含文件，为你处理大多数详细信息。
- 命令：
  - `Prefs INSTALLSCRIPT`
  - `Prefs SCRIPTS` -- 可以打开脚本管理对话框、选择脚本并（如果适用）打开其配置 UI。
    - 脚本通过文件名指定，并且通常使用通配符，以便无论末尾是否有 “.txt” 扩展名都可以使用。
    - 命令编辑器可以为你生成正确的命令和通配符。
    - //<示例://> `Prefs SCRIPTS=AlbumDoubleClick.vbs*`
  - `Prefs SCRIPTEDIT` -- 可以为指定的脚本打开脚本 IDE。
    - 与上述 `Prefs SCRIPTS` 相同的文件名和通配符。
    - //<示例://> `Prefs SCRIPTEDIT=AlbumDoubleClick.vbs*`
- 杂项：
  - 在创建新脚本时，现在可以选择将其创建为脚本包。（包允许将多个脚本和其它资源包含在一个文件中。）
  - 默认情况下，新建脚本对话框现在使用较新的 (Opus 12) OnAddCommands / OnAddColumns 语法为命令和列创建模板代码。

------------------------------------------------------------------------

接下来：[文件类型](/Manual/release_history/opus13_detailed/file_types.zh.md)