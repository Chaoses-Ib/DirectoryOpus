# 包括文件

有两种方法可以将一个较大的（通常是笨拙的）单个脚本文件拆分为多个文件。

- 脚本包含文件
- 脚本[模块](modules.zh.md)

这两个概念相似，然而，如果模块设计为将单个脚本拆分为多个文件的一种方式，则包含文件更多地被设计为在多个脚本之间共享代码。

假设您有一堆您喜欢重复使用的实用函数。您可以将它们复制到每个使用它们的单个脚本中，但这意味着您的脚本文件比它们需要的更大（并且更复杂），并且很难保持它们全部更新。

相反，如果您将实用函数保存在一个包含文件中，则可以将该文件*包括*到其他脚本中——自动获取其中函数的访问权限，但只需要一份代码副本。

##### 包括文件要求

创建包含文件的最简单方法是使用[脚本编辑器](../script_editor/README.zh.md)。

虽然包含文件就像其他任何文件一样都是脚本文件，但与普通脚本有一些重要的区别：

- 它们的**文件**名必须以**inc**_开头（例如 *inc_myutils.js*）。
- 它们必须与将使用它们的脚本使用相同的语言（例如，您不能从 .vbs 脚本中包括一个 .js 文件）。
- 可以实现[OnInitIncludeFile](/Manual/reference/scripting_reference/scripting_events/oninitincludefile.zh.md) 事件，以向 Opus 提供包含文件的信息，但这并不是必需的。

包含文件可以是*私有*的或*共享*的。私有包含文件在捆绑到[脚本包](script_package.zh.md)中时，只能由该包中的脚本使用。所有已安装的 Opus 脚本均可以使用共享包含文件。要将包含文件标记为共享，必须实现`OnInitIncludeFile`事件。

##### 使用包含文件

要从另一个脚本使用包含文件，请在脚本文件的顶部使用`@include`指令，例如，

`@include inc_myutils.js`

您还可以为包含文件指定最小版本。仅当包含文件通过实现`OnInitIncludeFile`事件指定了版本时，此方法才有效。

`@include inc_myutils.js:1.2`

您还可以从[脚本编辑器](/Manual/scripting/script_editor/README.zh.md)中选择包含文件。