**操作**

[文件类型编辑器](../filetype_editor/README.zh.md) 中的 **操作** 标签页用于配置各种“操作”的行为- 系统定义的标准命令（动词），并可将其用于各种类型文件。该标签页上的设置将影响整个系统中的文件类型的行为。[文件类型组](../file_type_groups.zh.md) 和大多数特殊 [Directory Opus 文件类型](../directory_opus_file_types.zh.md) 不具有操作标签页。

![](/Manual/images/media/filetypes_-_actions.png)

此屏幕截图显示了 **.doc** 文件（Word 文档）的 **操作** 标签页。可用的操作包括：

- **浏览**：此操作仅适用于文件夹，它定义“浏览”动词的功能。通常，当您右键单击文件夹并从上下文菜单中选择 **浏览** 时，会用到此操作。
- **查找**：此操作通常也仅用于文件夹，它定义“查找”动词的功能。
- **打开**：这是文件类型的 *通常* 默认操作 - 当您双击某个文件时，最常调用“打开”动词。当您对文件或文件夹右键单击并从上下文菜单中选择 **打开** 时，通常也会出现这种情况。
- **打印**：当您右键单击文件并从上下文菜单中选择 **打印** 时，通常会调用“打印”动词。它允许为不同文件类型定义默认打印处理程序。
- **打印到**：这是“打印”动词的一个变体，用于打印到特定打印机时使用。

在上述操作中，**浏览**、**打开** 和 **打印** 是最常用的操作。当操作显示在上下文菜单中时，它可能有标签，该标签不一定对应于动词的名称。如果已定义此类标签，则它将显示在操作列表中，而不是动词的名称中。如上图屏幕截图所示，这种情况实际上已经发生，尽管不明显 - “打开”操作的标签已被设置为 Open（大写字母）。

在操作标签页的底部，**编辑** 按钮允许您编辑所选操作（或您也可以直接双击操作），**删除** 按钮允许您删除它（清除定义），**设为默认值** 按钮允许您设置文件类型的默认操作（双击操作时会发生的情况）。通常，您不会想将此项从 **打开** 更改为其他内容 - 在以上屏幕截图中，**打开** 操作以粗体显示，表明它就是默认操作。

您还可以右键单击操作列表中的项目以显示该项目的上下文菜单。此上下文菜单允许您使用 **复制** 和 **粘贴** 将定义从一个操作复制到另一个操作。

编辑操作会显示 **编辑** 操作对话框。由于操作是全局设置（Windows 和 Opus 均使用），因此这不是一个功能齐全的 [函数编辑器](/Manual/customize/creating_your_own_buttons/command_editor/README.zh.md) 对话框，并且您无法将操作配置为使用 Opus 内部命令。相反，可以为一个操作定义两种类型的函数。

![](/Manual/images/media/open_action_-_run.png) 

第一种类型（从 **类型** 下拉菜单中选择）是 *运行应用程序*。这使您可以定义一个动作，该动作只是运行可执行程序。可以使用 **%1**[控制代码](/Manual/customize/creating_your_own_buttons/passing_files_to_external_programs.zh.md) 将文件名传递给程序。例如，用于打开 jpg 文件的命令行的操作命令为：

    C:\Windows\System32\rundll32.exe "C:\Program Files\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1

  
**操作** 字段允许您配置在此操作的上下文菜单中显示的标签。

![](/Manual/images/media/open_action_-_dde.png) 

第二种类型操作是 *DDE 命令*。这使用（相当过时的）[DDE 系统](http://en.wikipedia.org/wiki/Dynamic_Data_Exchange) 向应用程序发送命令，该应用程序可能正在运行，也可能尚未运行。上图显示了 Word 文档的 **打印** 操作。您会看到操作的标签已设置为 **&打印** - 在上下文菜单中，这将导致命令显示为 **打印**，且 **P** 下面带有下划线（表示可用于该功能的键）。

很遗憾，解释 DDE 的工作原理超出了本文档的范围，但值得庆幸的是，您极有可能永远不需要实际使用此系统。可以为 DDE 函数指定的参数包括：

- **应用程序：**用于在应用程序尚未运行时启动该应用程序的命令行。
- **DDE 消息：**发送到应用程序的消息，可让该应用程序对文件执行所需操作。
- **应用程序名：**应用程序的 DDE 名称。
- **主题：**用于启动 DDE 会话的 DDE 主题。
- **未运行：**如果应用程序尚未运行且需要启动，则使用的备用消息。